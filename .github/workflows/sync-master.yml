name: sync-master

on:
  push:
    branches: [ ci-sync ]
  # schedule:
  #   - cron: '0 4 * * 6' # https://crontab.guru/#0_4_*_*_6 "At 04:00 on Saturday."
  workflow_dispatch: # on button click

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          ref: master
      - run: hub --help
      - run: hub status
      - run: hub remote add upstream https://github.com/kaitai-io/kaitai_struct_formats.git
      - run: hub pull --rebase upstream master
      - run: hub push origin master
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
